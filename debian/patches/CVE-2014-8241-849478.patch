Description: XRegion in TigerVNC allowed remote VNC servers to cause a denial of service.
Author: Tim Waugh
Abstract:
 XRegion in TigerVNC allowed remote VNC servers to cause a denial of
 service (NULL pointer dereference) by leveraging failure to check a
 malloc return value, a similar issue to CVE-2014-6052.

Index: tigervnc-1.10.1+dfsg/common/Xregion/Region.c
===================================================================
--- tigervnc-1.10.1+dfsg.orig/common/Xregion/Region.c
+++ tigervnc-1.10.1+dfsg/common/Xregion/Region.c
@@ -1003,6 +1003,8 @@ miRegionOp(
 	    newReg->size = 1;
 	    Xfree(newReg->rects);
 	    newReg->rects = Xmalloc(sizeof(BoxRec));
+	    if (! newReg->rects )
+	      newReg->size = 0;
 	}
     }
     Xfree (oldRects);
